---
title: "Events"
description: ""
draft: false
weight: 3
bg_image: ""
toc : true
---

# TODO this needs updating

An event is a small packet of data that when processed causes some change in state. 

All events have the following attributes:
* `id  (str)` : the unique id of the event.
* `src (str)` : the source of the event (unique id).
* `dst (str)` : the destination of the event (unique id).
* `time (float)` : current time.
* `data (dict)` : a collection of additional values that may be used in processing the event.

## Widget Events
A widget displays part of the internal state to a user, they may also receive events. 
Events are generated by the various event sources in the ICU system, and may be generated by an interfacing external system. Each internal event source can be set up in the config.json file, for more details see [Configuration](https://github.com/dicelab-rhul/ICU/wiki/Configuration). 

Internal events will change the state of ICU and may trigger a widget to update. 

### System Monitoring
| Event | Description |
| ----- | ----------- |
| `event('<src>', 'WarningLight:<i>', label='switch')` | switch warning light `i` on/off |
| `event('<src>', 'WarningLight:<i>', label='click')`  | switch warning light `i` on/off |
| `event('<src>', 'Scale:<i>', label='slide', slide=<n>)` | slide a scale up or down by (+, -) n units |
| `event('<src>', 'Scale:<i>', label='click')` | resets the position of the scale slider | 

### Fuel Monitoring
| Event | Description |
| ----- | ----------- |
| `event('<src>', 'Pump:<ij>', label='transfer', flow=<f>)` | transform f fuel from tank i to tank j | 
| `event('<src>', 'Pump:<ij>', label='fail')` | cause the pump to fail | 
| `event('<src>', 'Pump:<ij>', label='repair')` | repair the pump (switch to normal operation)  | 
| `event('<src>', 'Pump:<ij>', label='click')` | switch pump on/off |
| `event('FuelTankMain:<i>', 'Global', label='fuel', acceptable=<a>)` | generated by a fuel tank when the fuel reaches and acceptable/unacceptable level. |



### Tracking
| Event | Description |
| ----- | ----------- |
| `event('<src>', 'Tracking:0', label='move', dx=<dx>, dy=<dy>)` | move the tracking widget target by (dx,dy) |

### Highlight 
All widgets have an associated highlighter which may receive highlight events. The id of a highlighter is derived from it associated widget `Highlight:<Widget ID>`, for example, `Highlight:WarningLight:0`. 
| Event | Description |
| ----- | ----------- |
| `event('<src>', 'Highlight:<widget id>', label='highlight')` | turn on/off the highlight of the given widget. |

### Overlay
The overlay widget can display graphics on top of other widgets. 
| Event | Description |
| ----- | ----------- |
| `event('<src>', 'Overlay:Overlay', label='overlay', x=<x>, y=<y>, text='<text>', graphic='<graphic_label>')` | Overlay text or predefined graphic at location (x,y) - pixel coordinates |

Custom overlay graphics must be registered with the overlay to associate a label (TODO). Text formatting options should also be specified as part of the [configuration](https://github.com/dicelab-rhul/ICU/wiki/Configuration). 

## Global Events

Global events are generated by ICU for use outside the system and are typically the result of user input, or an internal state change. Global events always have the `Global` event destination and are sent to all external sinks. 



## System Monitoring
| Event | Description |
| ----- | ----------- |
| `event('WarningLight:<i>', 'Global', label='click')`  | the user clicked a warning light |
| `event('Scale:<i>', 'Global', label='click')` | the user clicked a scale. | 

## Fuel Monitoring
| Event | Description |
| ----- | ----------- |
| `event('FuelTank:<i>', 'Global', label='fuel', acceptable=<a>)` | generated by a fuel tank when the fuel reaches an acceptable/unacceptable level (`<a> = True/False` respectively).  |
| `event( 'Pump:<ij>', 'Global', label='click')` | the user clicked a pump. |

## Tracking
| Event | Description |
| ----- | ----------- |



# External Events

Events are generated by event _sources_ and received by event _sinks_, all widgets are both a source and sink. Events can be generated and sent automatically to ICU by sub-classing the `event.ExternalEventSource` class and received by a sub-class of `event.ExternalEventSink`.




